<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:core="clr-namespace:RoofSheetMaster.Core;assembly=RoofSheetMaster.Core"
             x:Class="RoofSheetMaster.Desktop.Views.MaterialsView">

  <!--
    Panels + sheet summary + flashings view
  -->
  <Border Padding="10,10,20,10"
          Margin="0,0,0,0"
          BorderThickness="1"
          BorderBrush="#FFB0B0B0"
          Background="#FFF5F5F5">

    <!--
      Row 0: header
      Row 1: panel list
      Row 2: sheet summary header
      Row 3: sheet summary list
      Row 4: flashings header
      Row 5: flashings list
    -->
    <Grid RowDefinitions="Auto,*,Auto,Auto,Auto,Auto">

      <!-- Header -->
      <TextBlock Grid.Row="0"
                 Text="Panels / material list"
                 FontWeight="Bold"
                 Margin="0,0,0,5"
                 Foreground="#FF333333"/>

      <!-- Full panel list -->
      <ScrollViewer Grid.Row="1"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Auto">
        <ListBox x:Name="PanelListBox">
          <ListBox.ItemTemplate>
            <DataTemplate x:DataType="core:Panel">
              <TextBlock TextWrapping="Wrap" Margin="0,0,0,4">
                <Run Text="{Binding Face}" />
                <Run Text="  " />
                <Run Text="Panel " />
                <Run Text="{Binding Index}" />
                <Run Text=" | eavePos=" />
                <Run Text="{Binding EavePosition, StringFormat='{}{0:F3}'}" />
                <Run Text=" | cover=" />
                <Run Text="{Binding EffectiveWidth, StringFormat='{}{0:F3}'}" />
                <Run Text="&#x0a;length=" />
                <Run Text="{Binding SheetLength, StringFormat='{}{0:F3}'}" />
              </TextBlock>
            </DataTemplate>
          </ListBox.ItemTemplate>
        </ListBox>
      </ScrollViewer>

      <!-- Sheet summary header -->
      <TextBlock Grid.Row="2"
                 Text="Sheet summary (grouped by length)"
                 FontWeight="Bold"
                 Margin="0,10,0,5"
                 Foreground="#FF333333" />

      <!-- Sheet summary list -->
      <ScrollViewer Grid.Row="3"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Auto">
        <ListBox x:Name="SheetSummaryListBox">
          <ListBox.ItemTemplate>
            <DataTemplate x:DataType="core:SheetSummary">
              <TextBlock TextWrapping="Wrap" Margin="0,0,0,4">
                <Run Text="{Binding SheetLength, StringFormat='{}{0:F3}'}" />
                <Run Text=" length × " />
                <Run Text="{Binding Count}" />
                <Run Text=" pcs" />
              </TextBlock>
            </DataTemplate>
          </ListBox.ItemTemplate>
        </ListBox>
      </ScrollViewer>

      <!-- Flashings / accessories header -->
      <TextBlock Grid.Row="4"
                 Text="Flashings / accessories"
                 FontWeight="Bold"
                 Margin="0,10,0,5"
                 Foreground="#FF333333" />

      <!-- Flashings / accessories list -->
      <ScrollViewer Grid.Row="5"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Auto">
        <ListBox x:Name="FlashingListBox">
          <ListBox.ItemTemplate>
            <!-- IMPORTANT: FlashingSummary now lives in RoofSheetMaster.Core -->
            <DataTemplate x:DataType="core:FlashingSummary">
              <TextBlock TextWrapping="Wrap" Margin="0,0,0,4">
                <Run Text="{Binding Name}" />
                <Run Text=" – " />
                <Run Text="{Binding TotalLength, StringFormat='length {0:F3}'}" />
                <Run Text=", " />
                <Run Text="{Binding Count, StringFormat='count {0}'}" />
                <Run Text=" " />
                <Run Text="{Binding Notes}" />
              </TextBlock>
            </DataTemplate>
          </ListBox.ItemTemplate>
        </ListBox>
      </ScrollViewer>

    </Grid>
  </Border>
</UserControl>
